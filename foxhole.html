<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FOXHOLE API</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<style>

</style>
<script>
	$(document).ready(function () {//core by haydent foxholestats https://github.com/clapfoot/warapi/
	
		var loopTime = 10;//seconds
		var endpoint = 'https://war-service-live.foxholeservices.com/api';//shard1	
		var worldTotals,dayOfWar;
	
		function getData(){
			$.get(endpoint+'/worldconquest/maps', function(maps){//get list of maps
			
				worldTotals = {'colonialCasualties':0,'wardenCasualties':0, 'dayOfWar': 0};
				
				$.each(maps, function(i, mapName){//for each map

					$.get(endpoint+'/worldconquest/warReport/'+mapName, function(report){//get war reports
						//console.log(report);//output to look at structure
						worldTotals.colonialCasualties += report.colonialCasualties;
						worldTotals.wardenCasualties += report.wardenCasualties;
						worldTotals.dayOfWar = report.dayOfWar;
						if(i == maps.length-1)outputTotals();//run after last result success
					});		
					
					$.get(endpoint+'/worldconquest/maps/'+mapName+'/dynamic/public', function(report){//get dynamic data
						//console.log(report);//output to look at structure
						var mapSummary = {'mapName': mapName, 'seaports':0};
						$.each(report.mapItems, function(i, item){//for each map item							
							//do thing in here like sum up icon types for each team
							if(item.iconType == 52)mapSummary.seaports++;
						});
						outputMap(mapSummary);//print out result for map
					});					
							
				});
			});
		}
		getData();//start loop
		
		function outputTotals(){
		
			$('#totals').html('Warden Casulaties: '+worldTotals.wardenCasualties + ' ' + 'Colonial Casualties:' +worldTotals.colonialCasualties + ' Day: '+worldTotals.dayOfWar);	
			
		};
		function outputMap(mapSummary){
		
			$('#maps').append(mapSummary.mapName + ' Seaports: '+ mapSummary.seaports +'<br />');
		}

	});
</script>
</head>
<body>
<div id="totals"></div>
<br />
<div id="maps"></div>
</body>
</html>